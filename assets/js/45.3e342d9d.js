(window.webpackJsonp=window.webpackJsonp||[]).push([[45],{322:function(s,a,t){"use strict";t.r(a);var e=t(10),n=Object(e.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("blockquote",[a("p",[s._v("本文主要记录webpack编译node_modules依赖时，一些编译失败案例：")])]),s._v(" "),a("h2",{attrs:{id:"vue-lazyload开源组件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#vue-lazyload开源组件"}},[s._v("#")]),s._v(" vue-lazyload开源组件")]),s._v(" "),a("h3",{attrs:{id:"babel-loader编译时报错"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#babel-loader编译时报错"}},[s._v("#")]),s._v(" babel-loader编译时报错")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("ERROR  Failed to compile with "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" errors    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),s._v(":10:37\n error  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" ./node_modules/vue-lazyload/vue-lazyload.esm.js\nModule build failed "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("from ./node_modules/babel-loader/lib/index.js"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(":\nReferenceError: Unknown plugin "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"external-helpers"')]),s._v(" specified "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/Users/liujingfa/Documents/projects/plus-m-club/node_modules/vue-lazyload/.babelrc"')]),s._v(" at "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(", attempted to resolve relative to "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/Users/liujingfa/Documents/projects/plus-m-club/node_modules/vue-lazyload"')]),s._v("\n    at /Users/liujingfa/Documents/projects/plus-m-club/node_modules/babel-core/lib/transformation/file/options/option-manager.js:180:17\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("解决方案：babel-loader在转换js文件时，忽略掉对"),a("code",[s._v("vue-lazyload")]),s._v("的编译即可。问题来了，babel-loader编译js文件时，为何不直接忽略整个node_modules编译？因为公司内部的组件库有部分是需要进行编译才能用的。于是用以下方案解决此问题：")]),s._v(" "),a("h3",{attrs:{id:"解决方案"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#解决方案"}},[s._v("#")]),s._v(" 解决方案")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// bin/loadersConfig.js")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("test")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token regex"}},[a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[s._v("\\.js$")]),a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[s._v("/")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("use")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'babel-loader'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 排除babel-loader对vue-lazyload的编译")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("exclude")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token regex"}},[a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[s._v("node_modules\\/vue-lazyload")]),a("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[s._v("/")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[s._v("以上错误在mac和windows系统下必现。有趣的是，mac系统用了以上解决方案即可正常编译，windows系统则不行，这让用windows系统的同事愁了半天，后来想着先忽略整个"),a("code",[s._v("node_modules")]),s._v("的编译，然后再还原回"),a("code",[s._v("exclude: /node_modules\\/vue-lazyload/")]),s._v("即正常了。")]),s._v(" "),a("p",[s._v("然鹅，过了几天，另一个用windows系统的同事又遇到另一个错误，如下所示：")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("Uncaught ReferenceError: babelHelpers is not defined\n    at Function.ansiHTML.setColors "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("index.js:94"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    at "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("eval")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("webpack:///"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("/webpack"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("-hot-middleware/client-overlay.js?:42:10"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    at Object.QTqD "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("my_coupon.js:2581"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    at __webpack_require__ "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("my_coupon.js:790"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    at fn "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("my_coupon.js:101"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    at createReporter "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("webpack:///"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("/webpack"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("-hot-middleware/client.js?:136:15"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    at Object.eval "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("webpack:///"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("/webpack"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("-hot-middleware/client.js?:126:28"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    at "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("eval")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("webpack:///"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("/webpack"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("-hot-middleware/client.js?:245:30"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    at Object.+2aP "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("my_coupon.js:881"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    at __webpack_require__ "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("my_coupon.js:790"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("p",[s._v("本质原因是vue-lazyload.js 的babelrc配置里面添加了 babelHelpers 这个插件，然后运行的时候报错了。")]),s._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v('"presets"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"env"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v('"modules"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string-property property"}},[s._v('"plugins"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"external-helpers"')]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("p",[s._v("解决方案依然是在webpack配置中排除babel-loader对vue-lazyload的编译即可，操作也是先忽略整个"),a("code",[s._v("node_modules")]),s._v("的编译，然后再还原回"),a("code",[s._v("exclude: /node_modules\\/vue-lazyload/")]),s._v("即正常了。此时，让我唯一的感慨：前端开发配mac电脑才是标配啊！不然只能拖慢开发效率，导致协作开发也不愉快…")]),s._v(" "),a("h2",{attrs:{id:"参考资料"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考资料"}},[s._v("#")]),s._v(" 参考资料")]),s._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://github.com/hilongjw/vue-lazyload/issues/233",target:"_blank",rel:"noopener noreferrer"}},[s._v('Module build failed: ReferenceError: Unknown plugin "external-helpers"'),a("OutboundLink")],1)])])])}),[],!1,null,null,null);a.default=n.exports}}]);